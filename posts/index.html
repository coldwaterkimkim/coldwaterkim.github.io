<!DOCTYPE html>
<html>

<head>
  <title>My Blog Posts — coldwaterkim</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=800">
  <link rel="stylesheet" href="../css/styles.css">
  <script type="module">
    import { supabase } from '../js/supabase.js';

    const listEl = document.getElementById('post-list');

    async function loadPosts() {
      const { data, error } = await supabase
        .from('posts')
        .select('title, slug, date')
        .order('date', { ascending: false });

      if (error) {
        listEl.innerHTML = '<li>Error loading posts</li>';
        return;
      }

      if (!data || data.length === 0) {
        listEl.innerHTML = '<li>No posts yet.</li>';
        return;
      }

      const html = data.map(post => {
        return `<li><a href="view.html?slug=${post.slug}">${post.title}</a> — <i>${post.date}</i></li>`;
      }).join('');

      listEl.innerHTML = html;
    }

    loadPosts();
  </script>
</head>

<body>
  <center>
    <table width="760" border="1" cellspacing="0" cellpadding="8" bgcolor="#ffffff">
      <tr>
        <td>
          <h1>My Blog Posts</h1>
          <ul id="post-list">
            <li>Loading posts...</li>
          </ul>
          <p><a href="../index.html">← Back to Home</a></p>
        </td>
      </tr>
    </table>
  </center>
</body>

</html>